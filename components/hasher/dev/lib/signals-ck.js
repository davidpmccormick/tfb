/*jslint onevar:true, undef:true, newcap:true, regexp:true, bitwise:true, maxerr:50, indent:4, white:false, nomen:false, plusplus:false *//*global window:false, global:false*//*!!
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license <http://www.opensource.org/licenses/mit-license.php>
 * @author Miller Medeiros <http://millermedeiros.com/>
 * @version 0.6.3
 * @build 187 (07/11/2011 10:14 AM)
 */(function(e){function n(e,t,n,r,i){this._listener=t;this._isOnce=n;this.context=r;this._signal=e;this._priority=i||0}function r(e,t){if(typeof e!="function")throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}var t={VERSION:"0.6.3"};n.prototype={active:!0,params:null,execute:function(e){var t,n;if(this.active&&!!this._listener){n=this.params?this.params.concat(e):e;t=this._listener.apply(this.context,n);this._isOnce&&this.detach()}return t},detach:function(){return this.isBound()?this._signal.remove(this._listener):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", isBound: "+this.isBound()+", active: "+this.active+"]"}};t.Signal=function(){this._bindings=[]};t.Signal.prototype={_shouldPropagate:!0,active:!0,_registerListener:function(e,t,r,i){var s=this._indexOfListener(e),o;if(s!==-1){o=this._bindings[s];if(o.isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else{o=new n(this,e,t,r,i);this._addBinding(o)}return o},_addBinding:function(e){var t=this._bindings.length;do--t;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e){var t=this._bindings.length;while(t--)if(this._bindings[t]._listener===e)return t;return-1},add:function(e,t,n){r(e,"add");return this._registerListener(e,!1,t,n)},addOnce:function(e,t,n){r(e,"addOnce");return this._registerListener(e,!0,t,n)},remove:function(e){r(e,"remove");var t=this._indexOfListener(e);if(t!==-1){this._bindings[t]._destroy();this._bindings.splice(t,1)}return e},removeAll:function(){var e=this._bindings.length;while(e--)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(!this.active)return;var t=Array.prototype.slice.call(arguments),n=this._bindings.slice(),r=this._bindings.length;this._shouldPropagate=!0;do r--;while(n[r]&&this._shouldPropagate&&n[r].execute(t)!==!1)},dispose:function(){this.removeAll();delete this._bindings},toString:function(){return"[Signal active: "+this.active+" numListeners: "+this.getNumListeners()+"]"}};e.signals=t})(window||this);