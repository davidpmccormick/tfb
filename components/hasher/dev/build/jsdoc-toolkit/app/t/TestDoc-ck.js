var TestDoc={fails:0,plans:0,passes:0,results:[]};TestDoc.record=function(e){TestDoc.results.push(e);if(typeof e.verdict=="boolean"){e.verdict===!1&&TestDoc.fails++;e.verdict===!0&&TestDoc.passes++}};TestDoc.prove=function(e){typeof document!="undefined"&&typeof document.write!="undefined"&&(TestDoc.console?print=function(e){TestDoc.console.appendChild(document.createTextNode(e+"\n"))}:print=function(e){document.write(e+"<br />")});TestDoc.run(TestDoc.readFile(e))};TestDoc.run=function(src){try{eval(src)}catch(e){print("# ERROR! "+e)}var chunks=src.split(/\/\*t:/),run=function(chunk){var is=TestDoc.assertEquals,isnt=TestDoc.assertNotEquals,plan=TestDoc.plan,requires=TestDoc.requires;try{eval(chunk)}catch(e){print("# ERROR! "+e)}};for(var start=-1,end=0;(start=src.indexOf("/*t:",end))>end;start=end)run(src.substring(start+4,end=src.indexOf("*/",start)))};TestDoc.Result=function(e,t){this.verdict=e;this.message=t};TestDoc.Result.prototype.toString=function(){return typeof this.verdict=="boolean"?(this.verdict?"ok":"not ok")+" "+ ++TestDoc.report.counter+" - "+this.message:"# "+this.message};TestDoc.requires=function(e){if(!TestDoc.requires.loaded[e]){load(e);TestDoc.requires.loaded[e]=!0}};TestDoc.requires.loaded={};TestDoc.report=function(){TestDoc.report.counter=0;print("1.."+TestDoc.plans);for(var e=0;e<TestDoc.results.length;e++)print(TestDoc.results[e]);print("----------------------------------------");TestDoc.fails==0&&TestDoc.passes==TestDoc.plans?print("All tests successful."):print("Failed "+TestDoc.fails+"/"+TestDoc.plans+" tests, "+(TestDoc.plans==0?0:Math.round(TestDoc.passes/(TestDoc.passes+TestDoc.fails)*1e4)/100)+"% okay. Planned to run "+TestDoc.plans+", did run "+(TestDoc.passes+TestDoc.fails)+".")};TestDoc.plan=function(e,t){TestDoc.plans+=e;TestDoc.record(new TestDoc.Result(null,t+" ("+e+" tests)"))};TestDoc.assertEquals=function(e,t,n){var r=e==t;r||(n+="\n#\n# "+e+" does not equal "+t+"\n#");TestDoc.record(new TestDoc.Result(r,n))};TestDoc.assertNotEquals=function(e,t,n){var r=e!=t;r||(n+="\n#\n# "+e+" equals "+t+"\n#");TestDoc.record(new TestDoc.Result(r,n))};TestDoc.readFile=function(){return typeof readFile=="function"?function(e){var t=readFile(e);return t||""}:function(e){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!t)throw"Cannot create HTTP Request.";t.open("GET",e,!1);t.send("");if(t.readyState==4&&t.status>=400)throw"The HTTP Request returned an error code: "+t.status;return t.responseText||""}}();