typeof JSDOC=="undefined"&&(JSDOC={});JSDOC.Walker=function(e){this.init();typeof e!="undefined"&&this.walk(e)};JSDOC.Walker.prototype.init=function(){this.ts=null;var e=new JSDOC.Symbol("_global_",[],"GLOBAL",new JSDOC.DocComment(""));e.isNamespace=!0;e.srcFile="";e.isPrivate=!1;JSDOC.Parser.addSymbol(e);this.lastDoc=null;this.token=null;this.namescope=[e];this.namescope.last=function(e){e||(e=0);return this[this.length-(1+e)]||""}};JSDOC.Walker.prototype.walk=function(e){this.ts=e;while(this.token=this.ts.look()){if(this.token.popNamescope){var t=this.namescope.pop();t.is("FUNCTION")&&this.ts.look(1).is("LEFT_PAREN")&&t.comment.getTag("function").length==0&&(t.isa="OBJECT")}this.step();if(!this.ts.next())break}};JSDOC.Walker.prototype.step=function(){if(this.token.is("JSDOC")){var e=new JSDOC.DocComment(this.token.data);if(e.getTag("exports").length>0){var t=e.getTag("exports")[0];t.desc.match(/(\S+) as (\S+)/i);var n=RegExp.$1,r=RegExp.$2;if(!n&&r)throw"@exports tag requires a value like: 'name as ns.name'";JSDOC.Parser.rename=JSDOC.Parser.rename||{};JSDOC.Parser.rename[n]=r}if(e.getTag("lends").length>0){var i=e.getTag("lends")[0],s=i.desc;if(!s)throw"@lends tag requires a value.";var o=new JSDOC.Symbol(s,[],"OBJECT",e);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".");this.lastDoc=null;return!0}if(e.getTag("name").length>0&&e.getTag("overview").length==0){var a=e.getTag("name")[0].desc;if(!a)throw"@name tag requires a value.";if(e.getTag("memberOf").length>0){a=(e.getTag("memberOf")[0]+"."+a).replace(/([#.])\./,"$1");e.deleteTag("memberOf")}var o=new JSDOC.Symbol(a,[],"VIRTUAL",e);JSDOC.Parser.addSymbol(o);this.lastDoc=null;return!0}if(e.meta){if(e.meta=="@+")JSDOC.DocComment.shared=e.src;else if(e.meta=="@-")JSDOC.DocComment.shared="";else if(e.meta=="nocode+")JSDOC.Parser.conf.ignoreCode=!0;else{if(e.meta!="nocode-")throw"Unrecognized meta comment: "+e.meta;JSDOC.Parser.conf.ignoreCode=JSDOC.opt.n}this.lastDoc=null;return!0}if(e.getTag("overview").length>0){o=new JSDOC.Symbol("",[],"FILE",e);JSDOC.Parser.addSymbol(o);this.lastDoc=null;return!0}this.lastDoc=e;return!1}if(!JSDOC.Parser.conf.ignoreCode)if(this.token.is("NAME")){var o,s=this.token.data,e=null;this.lastDoc&&(e=this.lastDoc);var f=[];if(this.ts.look(1).is("COLON")&&this.ts.look(-1).is("LEFT_CURLY")&&!(this.ts.look(-2).is("JSDOC")||this.namescope.last().comment.getTag("lends").length||this.ts.look(-2).is("ASSIGN")||this.ts.look(-2).is("COLON"))){s="$anonymous";s=this.namescope.last().alias+"-"+s;f=[];o=new JSDOC.Symbol(s,f,"OBJECT",e);JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken(null,"RIGHT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(-1).is("FUNCTION")&&this.ts.look(1).is("LEFT_PAREN")){var l;this.lastDoc&&(e=this.lastDoc);if(e&&e.getTag("memberOf").length>0){s=(e.getTag("memberOf")[0]+"."+s).replace("#.","#");e.deleteTag("memberOf")}else{s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0)}this.namescope.last().is("GLOBAL")||(l=!0);f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));o=new JSDOC.Symbol(s,f,"FUNCTION",e);l&&(o.isInner=!0);if(this.ts.look(1).is("JSDOC")){var c=""+this.ts.look(1).data;c=c.replace(/(^\/\*\* *| *\*\/$)/g,"");o.type=c}JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("ASSIGN")&&this.ts.look(2).is("FUNCTION")){var h,p=!1;if(e&&(h=e.getTag("constructs"))&&h.length&&h[0].desc){s=h[0].desc;p=!0}var l;if(this.ts.look(-1).is("VAR")||this.isInner){if(e&&e.getTag("memberOf").length>0){s=(e.getTag("memberOf")[0]+"."+s).replace("#.","#");e.deleteTag("memberOf")}else{s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0)}this.namescope.last().is("GLOBAL")||(l=!0)}else s.indexOf("this.")==0&&(s=this.resolveThis(s));this.lastDoc&&(e=this.lastDoc);f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));o=new JSDOC.Symbol(s,f,"FUNCTION",e);l&&(o.isInner=!0);p&&(o.isa="CONSTRUCTOR");if(this.ts.look(1).is("JSDOC")){var c=""+this.ts.look(1).data;c=c.replace(/(^\/\*\* *| *\*\/$)/g,"");o.type=c}JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("ASSIGN")&&(this.ts.look(2).is("NEW")||this.ts.look(2).is("LEFT_PAREN"))&&this.ts.look(3).is("FUNCTION")){var l;if(this.ts.look(-1).is("VAR")||this.isInner){s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0)}else s.indexOf("this.")==0&&(s=this.resolveThis(s));this.ts.next(3);this.lastDoc&&(e=this.lastDoc);f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));o=new JSDOC.Symbol(s,f,"OBJECT",e);l&&(o.isInner=!0);if(this.ts.look(1).is("JSDOC")){var c=""+this.ts.look(1).data;c=c.replace(/(^\/\*\* *| *\*\/$)/g,"");o.type=c}JSDOC.Parser.addSymbol(o);o.scopeType="INSTANCE";this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("COLON")&&this.ts.look(2).is("FUNCTION")){s=(this.namescope.last().alias+"."+s).replace("#.","#");this.lastDoc&&(e=this.lastDoc);f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));if(e&&e.getTag("constructs").length){s=s.replace(/\.prototype(\.|$)/,"#");s.indexOf("#")>-1?s=s.match(/(^[^#]+)/)[0]:s=this.namescope.last().alias;o=new JSDOC.Symbol(s,f,"CONSTRUCTOR",e)}else o=new JSDOC.Symbol(s,f,"FUNCTION",e);if(this.ts.look(1).is("JSDOC")){var c=""+this.ts.look(1).data;c=c.replace(/(^\/\*\* *| *\*\/$)/g,"");o.type=c}JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("ASSIGN")&&this.ts.look(2).is("LEFT_CURLY")){var l;if(this.ts.look(-1).is("VAR")||this.isInner){s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0)}else s.indexOf("this.")==0&&(s=this.resolveThis(s));this.lastDoc&&(e=this.lastDoc);o=new JSDOC.Symbol(s,f,"OBJECT",e);l&&(o.isInner=!0);e&&JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("SEMICOLON")){var l;if(this.ts.look(-1).is("VAR")||this.isInner){s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0);this.lastDoc&&(e=this.lastDoc);o=new JSDOC.Symbol(s,f,"OBJECT",e);l&&(o.isInner=!0);e&&JSDOC.Parser.addSymbol(o)}}else if(this.ts.look(1).is("ASSIGN")){var l;if(this.ts.look(-1).is("VAR")||this.isInner){s=this.namescope.last().alias+"-"+s;this.namescope.last().is("GLOBAL")||(l=!0)}else s.indexOf("this.")==0&&(s=this.resolveThis(s));this.lastDoc&&(e=this.lastDoc);o=new JSDOC.Symbol(s,f,"OBJECT",e);l&&(o.isInner=!0);e&&JSDOC.Parser.addSymbol(o)}else if(this.ts.look(1).is("COLON")&&this.ts.look(2).is("LEFT_CURLY")){s=(this.namescope.last().alias+"."+s).replace("#.","#");this.lastDoc&&(e=this.lastDoc);o=new JSDOC.Symbol(s,f,"OBJECT",e);e&&JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}else if(this.ts.look(1).is("COLON")){s=(this.namescope.last().alias+"."+s).replace("#.","#");this.lastDoc&&(e=this.lastDoc);o=new JSDOC.Symbol(s,f,"OBJECT",e);e&&JSDOC.Parser.addSymbol(o)}else if(this.ts.look(1).is("LEFT_PAREN")&&typeof JSDOC.PluginManager!="undefined"){var d={name:s},v=this.ts.cursor;f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));this.ts.cursor=v;for(var m=0;m<f.length;m++)d["arg"+(m+1)]=f[m].name;JSDOC.PluginManager.run("onFunctionCall",d);d.doc&&this.ts.insertAhead(new JSDOC.Token(d.doc,"COMM","JSDOC"))}this.lastDoc=null}else if(this.token.is("FUNCTION")&&(!this.ts.look(-1).is("COLON")||!this.ts.look(-1).is("ASSIGN"))&&!this.ts.look(1).is("NAME")){this.lastDoc&&(e=this.lastDoc);s="$anonymous";s=this.namescope.last().alias+"-"+s;f=JSDOC.Walker.onParamList(this.ts.balance("LEFT_PAREN"));o=new JSDOC.Symbol(s,f,"FUNCTION",e);JSDOC.Parser.addSymbol(o);this.namescope.push(o);var u=this.ts.getMatchingToken("LEFT_CURLY");u?u.popNamescope=s:LOG.warn("Mismatched } character. Can't parse code in file "+o.srcFile+".")}return!0};JSDOC.Walker.prototype.resolveThis=function(e){e.match(/^this\.(.+)$/);var t=RegExp.$1;if(!t)return e;var n=this.namescope.last(),r=n.scopeType||n.isa;if(r=="CONSTRUCTOR")e=n.alias+"#"+t;else if(r=="INSTANCE")e=n.alias+"."+t;else if(r=="FUNCTION")if(n.alias.match(/(^.*)[#.-][^#.-]+/)){var i=RegExp.$1,s=JSDOC.Parser.symbols.getSymbol(i);s||(JSDOC.Lang.isBuiltin(i)?s=JSDOC.Parser.addBuiltin(i):n.alias.indexOf("$anonymous")<0&&LOG.warn("Trying to document "+n.alias+" without first documenting "+i+"."));s&&(e=i+(s.is("CONSTRUCTOR")?"#":".")+t)}else{s=this.namescope.last(1);e=s.alias+(s.is("CONSTRUCTOR")?"#":".")+t}else e=t;return e};JSDOC.Walker.onParamList=function(e){if(!e){LOG.warn("Malformed parameter list. Can't parse code.");return[]}var t=[];for(var n=0,r=e.length;n<r;n++)if(e[n].is("JSDOC")){var i=e[n].data.replace(/(^\/\*\* *| *\*\/$)/g,"");if(e[n+1]&&e[n+1].is("NAME")){n++;t.push({type:i,name:e[n].data})}}else e[n].is("NAME")&&t.push({name:e[n].data});return t};