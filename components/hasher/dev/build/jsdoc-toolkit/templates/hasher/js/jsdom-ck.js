/*
 * The contents of this file are subject to the Mozilla Public License
 * Version 1.1 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 * 
 * Software distributed under the License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
 * License for the specific language governing rights and limitations
 * under the License.
 * 
 * The Initial Developer of the Original Code is Steffen Siering. All Rights Reserved.
 */(function(){function e(){return this}function t(e,t,n){this.nodeType=1;this.initialized=!1;this.style="";this.className="";this.id=null;this.lang=null;var n=n?$A(n).filter(function(e){if(e.nodeName=="class"){this.className=e.nodeValue;return!1}if(e.nodeName=="id"){this.id=e.nodeValue;return!1}if(e.nodeName=="lang"){this.lang=e.nodeValue;return!1}if(e.nodeName=="style"){this.style=e.nodeValue;return!1}return!0},this):[];this.tagName=t;this.attrs=n;this.parentNode=e;this.childNodes=[];this.$family=!0;this.nodeName=t.toUpperCase();this.firstChild=null;this.lastChild=null;this.nextSibling=null;this.previousSibling=null;this.initialized=!0;return this}function n(e){this.nodeType=3;this.nodeValue=String(e);this.nodeName="#text";return this}function r(e,n,r,i){r=r.map(function(e){return{nodeName:e.name,nodeValue:e.value,nodeType:2}});return new t(e,n,r)}function i(e){if(!e.childNodes||e.childNodes.length===0)return;e.firstChild=e.childNodes[0];var t=null;e.childNodes.forEach(function(n){n.parentNode=e;if(t){t.nextSibling=n;n.previousSibling=t}t=n});e.lastChild=t;t.nextSibling=null}function s(e){var t=[],s=null,o=[];HTMLParser(e,{start:function(e,n,i){if(i)(s?s.childNodes:o).push(r(s,e,n));else{s&&t.push(s);s=r(s,e,n,i)}},end:function(e){var n=t.pop();($defined(n)&&n?n.childNodes:o).push(s);i(s);s=n},chars:function(e){if(!e||e.trim()=="")return;(s?s.childNodes:o).push(new n(e))}});return o.length==1?o[0]:o}this.DomAbstract=e;e.constructor=e;e.prototype.__doGetElementsBy=function(){return[]};e.prototype.getElementsByTagName=function(){return[]};e.prototype.getElementById=function(){return null};e.prototype.getAttribute=function(){return""};e.prototype.setAttribute=function(){};e.prototype.removeAttribute=function(){};e.prototype.cloneNode=function(){};e.prototype.uid=1;e.prototype.nodeValue=null;e.prototype.firstChild=null;e.prototype.nextSibling=null;e.prototype.previousSibling=null;e.prototype.style="";e.prototype.getInnerHTML=function(){};e.prototype.setInnerHTML=function(e){};e.prototype.getInnerText=function(){};e.prototype.setInnerText=function(){};e.prototype.getOuterHTML=function(){};e.prototype.setOuterHTML=function(){};e.prototype.__defineGetter__("innerText",function(){return});e.prototype.__defineSetter__("innerText",function(e){this.setInnerText(e)});e.prototype.__defineGetter__("innerHTML",function(){return this.getInnerHTML()});e.prototype.__defineSetter__("innerHTML",function(e){this.setInnerHTML(e)});e.prototype.__defineGetter__("outerHTML",function(){return this.getOuterHTML()});e.prototype.__defineSetter__("outerHTML",function(e){this.setOuterHTML(e)});this.DomElement=t;t.constructor=t;t.prototype=new e;t.prototype.cloneNode=function(e){var n=arguments.length==0?!0:e,r=new t(undefined,this.tagName,this.copyAttributes);r.className=this.className?this.className:"";r.id=this.id?this.id:null;r.lang=this.lang?this.lang:null;r.style=this.style?this.style:null;e&&(r.childNodes=this.childNodes.map(function(t){var n=t.cloneNode(e);return n}));i(r);return r};t.prototype.copyAttributes=function(){this.attrs.map(function(e){return{nodeName:e.nodeName,nodeValue:e.nodeValue,nodeType:e.nodeType}})};t.prototype.appendChild=function(e){e.parentNode&&e.parentNode.removeChild(e);this.childNodes.push(e);e.nextSibling=null;e.previousSibling=this.last;e.parentNode=this;this.lastChild=e};t.prototype.hasChildNodes=function(){return this.childNodes.length>0};t.prototype.insertBefore=function(e,t){(arguments.length===1||!t)&&this.appendChild(e);e.parentNode&&e.parentNode.removeChild(e);e.parentNode=this;e.previousSibling=t.previousSibling;e.nextSibling=t;t.previousSibling=e;var n=this.childNodes.indexOf(t);this.childNodes.splice(n,0,e)};t.prototype.removeChild=function(e){if(!e||!e.parentNode||e.parentNode!==this)return undefined;this.childNodes.erase(e);e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling);e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling);e.parentNode=null;e.previousSibling=e.nextSibling=null;return e};t.prototype.replaceChild=function(e,t){e.parentNode&&e.parentNode.removeChild(e);e.parentNode=this;e.previousSibling=t.previousSibling;e.previousSibling.nextSibling=e;e.nextSibling=t.previousSibling;e.nextSibling.previousSibling=e;this.lastChild==t&&(this.lastChild=e);var n=this.childNodes.indexOf(t);this.childNodes.splice(n,1,e);return t};t.prototype.__doGetElementsBy=function(e,t){var n=[];this.childNodes.map(function(n){if(!n.__doGetElementsBy)return[];var r=n.__doGetElementsBy(e,t);return e(n)?[n].concat(r):r}).each(function(e){e&&e.length>0&&(n=n.concat(e.filter(function(e){return e})))});return!n||n.length==0?null:n};t.prototype.getElementsByTagName=function(e){return this.__doGetElementsBy(e==="*"?function(e){return e.nodeType==1}:function(t){return t.tagName==e},!1)};t.prototype.getElementById=function(e){var t=this.__doGetElementsBy(function(e){return e.id==name},!1);return t&&t.length>0?t[0]:undefined};t.prototype.getElement=$defined(this.Element)?Element.prototype.getElement:function(e){return this.getElements(e)[0]||null};t.prototype.getElements=$defined(this.Element)?function(){var e=Element.prototype.getElements.apply(this,arguments);return e}:function(e){e=e.split(",");var t=null;e.each(function(e){e=e.trim().toLowerCase();var n=this.getElementsByTagName(e);t=t?t.concat(n):n},this);return t?t:[]};t.prototype.getAttribute=function(e){if(e==="id")return this.id;if(e==="lang")return this.lang;for(var t=0;t<this.attrs.length;t++)if(this.attrs[t].nodeName==e)return this.attrs[t].nodeValue;return""};t.prototype.setAttribute=function(e,t){for(var n=0;n<this.attrs.length;n++)this.attrs[n].nodeName==e&&(this.attrs[n].nodeValue=t)};t.prototype.removeAttribute=function(e){for(var t=0;t<this.attrs.length;t++)if(this.attrs[t].nodeName==e){this.attrs.splice(t,1);return}};t.prototype.getProperty=$defined(this.Element)?Element.prototype.getProperty:undefined,t.prototype.setProperty=$defined(this.Element)?Element.prototype.setProperty:undefined,t.prototype.removeProperty=$defined(this.Element)?Element.prototype.removeProperty:undefined,t.prototype.getProperties=$defined(this.Element)?Element.prototype.getProperties:undefined,t.prototype.setProperties=$defined(this.Element)?Element.prototype.setProperties:undefined,t.prototype.removeProperties=$defined(this.Element)?Element.prototype.removeProperties:undefined,t.prototype.hasClass=$defined(this.Element)?Element.prototype.hasClass:function(e){return this.className.contains(e," ")};if($defined(this.Element)){t.prototype.get=$defined(this.Element)?Element.prototype.get:undefined;t.prototype.set=$defined(this.Element)?Element.prototype.set:undefined}t.prototype.addClass=function(e){this.hasClass(e)||(this.className=(this.className+" "+e).clean());return this};t.prototype.removeClass=function(e){var t=new RegExp("(^|\\s)"+e+"(?:\\s|$)");this.className=this.className.replace(t,"$1");return this};t.prototype.toggleClass=function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e)};t.prototype.getInnerHTML=function(){if(!this.initialized)return"";var e="";this.childNodes&&this.childNodes.length>0&&this.childNodes.forEach(function(t){e+=t.getOuterHTML()});return e};t.prototype.setInnerHTML=function(e){this.childNodes=s(e);i(this)};t.prototype.getOuterHTML=function(){function n(e,n){n&&(t+=" "+e+'="'+n+'"')}if(!this.initialized)return;var e=this,t="<"+e.tagName;n("id",this.id);n("class",this.className);n("lang",this.lang);n("style",this.style);e.attrs.forEach(function(e){n(e.nodeName,e.nodeValue)});t+=">";t+=this.getInnerHTML();t+="</"+e.tagName+">";return t};t.prototype.setOuterHTML=function(){throw"property outerHTML is read only"};this.DomText=n;n.constructor=n;n.prototype=new e;n.prototype.cloneNode=function(){return new n(this.nodeValue.substr(0))};n.prototype.getOuterHTML=function(){return this.nodeValue};n.prototype.setOuterHTML=function(e){var t=s(e)[0];$extend(this,t);this.nodeType=t.nodeType;this.nodeName=t.nodeName};n.prototype.getInnerHTML=function(){return this.nodeValue};n.prototype.setInnerHTML=function(e){return this.nodeValue};n.prototype.getInnerText=function(){return unescape(this.nodeValue)};n.prototype.setInnerText=function(e){this.nodeValue=escape(e)};this.parseDom=s})();