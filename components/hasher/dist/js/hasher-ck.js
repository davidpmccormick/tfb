/*!!
 * Hasher <http://github.com/millermedeiros/hasher>
 * @author Miller Medeiros
 * @version 1.1.3 (2013/03/14 07:02 PM)
 * Released under the MIT License
 */(function(){var e=function(e){var t=function(t){function b(e){return String(e||"").replace(/[\\.+*?\^$\[\](){}\/'#]/g,"\\$&")}function w(e){if(!e)return"";var t=new RegExp("^"+b(o.prependHash)+"|"+b(o.appendHash)+"$","g");return e.replace(t,"")}function E(){var e=h.exec(o.getURL());return e&&e[1]?decodeURIComponent(e[1]):""}function S(){return l?l.contentWindow.frameHash:null}function x(){l=r.createElement("iframe");l.src="about:blank";l.style.display="none";r.body.appendChild(l)}function T(){if(l&&u!==S()){var e=l.contentWindow.document;e.open();e.write("<html><head><title>"+r.title+'</title><script type="text/javascript">var frameHash="'+u+'";</script></head><body>&nbsp;</body></html>');e.close()}}function N(e,t){if(u!==e){var n=u;u=e;g&&(t?l.contentWindow.frameHash=e:T());o.changed.dispatch(w(e),w(n))}}function C(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function k(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function L(e){e=Array.prototype.slice.call(arguments);var t=e.join(o.separator);t=t?o.prependHash+t.replace(d,"")+o.appendHash:t;return t}function A(e){e=encodeURI(e);v&&y&&(e=e.replace(/\?/,"%3F"));return e}var n=25,r=t.document,i=t.history,s=e.Signal,o,u,a,f,l,c,h=/#(.*)$/,p=/(\?.*)|(\#.*)/,d=/^\#/,v=!1,m="onhashchange"in t&&r.documentMode!==7,g=v&&!m,y=location.protocol==="file:";g?c=function(){var e=E(),t=S();t!==u&&t!==e?o.setHash(w(t)):e!==u&&N(e)}:c=function(){var e=E();e!==u&&N(e)};o={VERSION:"1.1.3",appendHash:"",prependHash:"/",separator:"/",changed:new s,stopped:new s,initialized:new s,init:function(){if(f)return;u=E();if(m)C(t,"hashchange",c);else{if(g){l||x();T()}a=setInterval(c,n)}f=!0;o.initialized.dispatch(w(u))},stop:function(){if(!f)return;if(m)k(t,"hashchange",c);else{clearInterval(a);a=null}f=!1;o.stopped.dispatch(w(u))},isActive:function(){return f},getURL:function(){return t.location.href},getBaseURL:function(){return o.getURL().replace(p,"")},setHash:function(e){e=L.apply(null,arguments);if(e!==u){N(e);e===u&&(t.location.hash="#"+A(e))}},replaceHash:function(e){e=L.apply(null,arguments);if(e!==u){N(e,!0);e===u&&t.location.replace("#"+A(e))}},getHash:function(){return w(u)},getHashAsArray:function(){return o.getHash().split(o.separator)},dispose:function(){o.stop();o.initialized.dispose();o.stopped.dispose();o.changed.dispose();l=o=t.hasher=null},toString:function(){return'[hasher version="'+o.VERSION+'" hash="'+o.getHash()+'"]'}};o.initialized.memorize=!0;return o}(window);return t};typeof define=="function"&&define.amd?define(["signals"],e):window.hasher=e(window.signals)})();