/*
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */// A wrapper for compatibility with Mustache.js, quirks and all
var Hogan={};(function(e){function u(e){e=String(e===null||e===undefined?"":e);return o.test(e)?e.replace(t,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(i,"&#39;").replace(s,"&quot;"):e}e.Template=function f(e,t,n){e&&(this.r=e);this.c=n;this.text=t||""};e.Template.prototype={r:function(e,t,n){return""},v:u,render:function(t,n,r){return this.ri([t],n||{},r)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,r){var i=n[e];if(!i)return"";this.c&&typeof i=="string"&&(i=this.c.compile(i));return i.ri(t,n,r)},rs:function(e,t,n){var r="",i=e[e.length-1];if(!a(i))return r=n(e,t);for(var s=0;s<i.length;s++){e.push(i[s]);r+=n(e,t);e.pop()}return r},s:function(e,t,n,r,i,s,o){var u;if(a(e)&&e.length===0)return!1;typeof e=="function"&&(e=this.ls(e,t,n,r,i,s,o));u=e===""||!!e;!r&&u&&t&&t.push(typeof e=="object"?e:t[t.length-1]);return u},d:function(e,t,n,r){var i=e.split("."),s=this.f(i[0],t,n,r),o=null;if(e==="."&&a(t[t.length-2]))return t[t.length-1];for(var u=1;u<i.length;u++)if(s&&typeof s=="object"&&i[u]in s){o=s;s=s[i[u]]}else s="";if(r&&!s)return!1;if(!r&&typeof s=="function"){t.push(o);s=this.lv(s,t,n);t.pop()}return s},f:function(e,t,n,r){var i=!1,s=null,o=!1;for(var u=t.length-1;u>=0;u--){s=t[u];if(s&&typeof s=="object"&&e in s){i=s[e];o=!0;break}}if(!o)return r?!1:"";!r&&typeof i=="function"&&(i=this.lv(i,t,n));return i},ho:function(e,t,n,r,i){var s=this.c,o=e.call(t,r,function(e){return s.compile(e,{delimiters:i}).render(t,n)}),u=s.compile(o.toString(),{delimiters:i}).render(t,n);this.b=u;return!1},b:"",ls:function(e,t,n,r,i,s,o){var u=t[t.length-1],a=null;if(!r&&this.c&&e.length>0)return this.ho(e,u,n,this.text.substring(i,s),o);a=e.call(u);if(typeof a=="function"){if(r)return!0;if(this.c)return this.ho(a,u,n,this.text.substring(i,s),o)}return a},lv:function(e,t,n){var r=t[t.length-1],i=e.call(r);typeof i=="function"&&(i=i.call(r));i=i.toString();return this.c&&~i.indexOf("{{")?this.c.compile(i).render(r,n):i}};var t=/&/g,n=/</g,r=/>/g,i=/\'/g,s=/\"/g,o=/[&<>\"\']/,a=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}})(typeof exports!="undefined"?exports:Hogan);(function(e){function u(e){e.n.substr(e.n.length-1)==="}"&&(e.n=e.n.substring(0,e.n.length-1))}function a(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function f(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var r=1,i=e.length;r<i;r++)if(t.charAt(n+r)!=e.charAt(r))return!1;return!0}function l(e,t,n,r){var i=[],s=null,o=null;while(e.length>0){o=e.shift();if(o.tag=="#"||o.tag=="^"||c(o,r)){n.push(o);o.nodes=l(e,o.tag,n,r);i.push(o)}else{if(o.tag=="/"){if(n.length===0)throw new Error("Closing tag without opener: /"+o.n);s=n.pop();if(o.n!=s.n&&!h(o.n,s.n,r))throw new Error("Nesting error: "+s.n+" vs. "+o.n);s.end=o.i;return i}i.push(o)}}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return i}function c(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].o==e.n){e.tag="#";return!0}}function h(e,t,n){for(var r=0,i=n.length;r<i;r++)if(n[r].c==e&&n[r].o==t)return!0}function p(e){return'i = i || "";var b = i + "";var _ = this;'+m(e)+"return b;"}function d(e){return e.replace(s,"\\\\").replace(n,'\\"').replace(r,"\\n").replace(i,"\\r")}function v(e){return~e.indexOf(".")?"d":"f"}function m(e){var t="";for(var n=0,r=e.length;n<r;n++){var i=e[n].tag;i=="#"?t+=g(e[n].nodes,e[n].n,v(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):i=="^"?t+=y(e[n].nodes,e[n].n,v(e[n].n)):i=="<"||i==">"?t+=b(e[n]):i=="{"||i=="&"?t+=w(e[n].n,v(e[n].n)):i=="\n"?t+=S('"\\n"'+(e.length-1==n?"":" + i")):i=="_v"?t+=E(e[n].n,v(e[n].n)):i===undefined&&(t+=S('"'+d(e[n])+'"'))}return t}function g(e,t,n,r,i,s){return"if(_.s(_."+n+'("'+d(t)+'",c,p,1),'+"c,p,0,"+r+","+i+', "'+s+'")){'+"b += _.rs(c,p,"+'function(c,p){ var b = "";'+m(e)+"return b;});c.pop();}"+'else{b += _.b; _.b = ""};'}function y(e,t,n){return"if (!_.s(_."+n+'("'+d(t)+'",c,p,1),c,p,1,0,0,"")){'+m(e)+"};"}function b(e){return'b += _.rp("'+d(e.n)+'",c,p,"'+(e.indent||"")+'");'}function w(e,t){return"b += (_."+t+'("'+d(e)+'",c,p,0));'}function E(e,t){return"b += (_.v(_."+t+'("'+d(e)+'",c,p,0)));'}function S(e){return"b += "+e+";"}var t=/\S/,n=/\"/g,r=/\n/g,i=/\r/g,s=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};e.scan=function(n,r){function S(){if(v.length>0){m.push(new String(v));v=""}}function x(){var e=!0;for(var n=b;n<m.length;n++){e=m[n].tag&&o[m[n].tag]<o._v||!m[n].tag&&m[n].match(t)===null;if(!e)return!1}return e}function T(e,t){S();if(e&&x()){for(var n=b,r;n<m.length;n++)if(!m[n].tag){(r=m[n+1])&&r.tag==">"&&(r.indent=m[n].toString());m.splice(n,1)}}else t||m.push({tag:"\n"});g=!1;b=m.length}function N(e,t){var n="="+E,r=e.indexOf(n,t),i=a(e.substring(e.indexOf("=",t)+1,r)).split(" ");w=i[0];E=i[1];return r+n.length-1}var i=n.length,s=0,l=1,c=2,h=s,p=null,d=null,v="",m=[],g=!1,y=0,b=0,w="{{",E="}}";if(r){r=r.split(" ");w=r[0];E=r[1]}for(y=0;y<i;y++)if(h==s)if(f(w,n,y)){--y;S();h=l}else n.charAt(y)=="\n"?T(g):v+=n.charAt(y);else if(h==l){y+=w.length-1;d=o[n.charAt(y+1)];p=d?n.charAt(y+1):"_v";if(p=="="){y=N(n,y);h=s}else{d&&y++;h=c}g=y}else if(f(E,n,y)){m.push({tag:p,n:a(v),otag:w,ctag:E,i:p=="/"?g-E.length:y+w.length});v="";y+=E.length-1;h=s;p=="{"&&(E=="}}"?y++:u(m[m.length-1]))}else v+=n.charAt(y);T(g,!0);return m};e.generate=function(t,n,r){return r.asString?"function(c,p,i){"+t+";}":new e.Template(new Function("c","p","i",t),n,e)};e.parse=function(e,t){t=t||{};return l(e,"",[],t.sectionTags||[])},e.cache={};e.compile=function(e,t){t=t||{};var n=e+"||"+!!t.asString,r=this.cache[n];if(r)return r;r=this.generate(p(this.parse(this.scan(e,t.delimiters),t)),e,t);return this.cache[n]=r}})(typeof exports!="undefined"?exports:Hogan);var Mustache=function(e){function t(t,n,r,i){var s=this.f(t,n,r,0),o=n;s&&(o=o.concat(s));return e.Template.prototype.rp.call(this,t,o,r,i)}var n=function(n,r,i){this.rp=t;e.Template.call(this,n,r,i)};n.prototype=e.Template.prototype;var r,i=function(){this.cache={};this.generate=function(e,t,i){return new n(new Function("c","p","i",e),t,r)}};i.prototype=e;r=new i;return{to_html:function(e,t,n,i){var s=r.compile(e),o=s.render(t,n);if(!i)return o;i(o)}}}(Hogan);