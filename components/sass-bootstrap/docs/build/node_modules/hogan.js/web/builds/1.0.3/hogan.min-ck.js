/**
* @preserve Copyright 2012 Twitter, Inc.
* @license http://www.apache.org/licenses/LICENSE-2.0.txt
*/var HoganTemplate=function(){function e(e){this.text=e}function t(e){return e=String(e===null?"":e),u.test(e)?e.replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(s,"&#39;").replace(o,"&quot;"):e}e.prototype={r:function(e,t,n){return""},v:t,render:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,r){var i=n[e];return i?i.r(t,n,r):""},rs:function(e,t,n){var r="",i=e[e.length-1];if(!a(i))return r=n(e,t);for(var s=0;s<i.length;s++)e.push(i[s]),r+=n(e,t),e.pop();return r},s:function(e,t,n,r,i,s,o){var u;return a(e)&&e.length===0?!1:(!r&&typeof e=="function"&&(e=this.ls(e,t,n,i,s,o)),u=e===""||!!e,!r&&u&&t&&t.push(typeof e=="object"?e:t[t.length-1]),u)},d:function(e,t,n,r){var i=e.split("."),s=this.f(i[0],t,n,r),o=null;if(e==="."&&a(t[t.length-2]))return t[t.length-1];for(var u=1;u<i.length;u++)s&&typeof s=="object"&&i[u]in s?(o=s,s=s[i[u]]):s="";return r&&!s?!1:(!r&&typeof s=="function"&&(t.push(o),s=this.lv(s,t,n),t.pop()),s)},f:function(e,t,n,r){var i=!1,s=null,o=!1;for(var u=t.length-1;u>=0;u--){s=t[u];if(s&&typeof s=="object"&&e in s){i=s[e],o=!0;break}}return o?(!r&&typeof i=="function"&&(i=this.lv(i,t,n)),i):r?!1:""},ho:function(e,t,n,r,i){var s=e.call(t,r,function(e){return Hogan.compile(e,{delimiters:i}).render(t,n)}),o=Hogan.compile(s.toString(),{delimiters:i}).render(t,n);return this.b=o,!1},b:"",ls:function(e,t,n,r,i,s){var o=t[t.length-1],u=e.call(o);return e.length>0?this.ho(e,o,n,this.text.substring(r,i),s):typeof u=="function"?this.ho(u,o,n,this.text.substring(r,i),s):u},lv:function(e,t,n){var r=t[t.length-1];return Hogan.compile(e.call(r).toString()).render(r,n)}};var n=/&/g,r=/</g,i=/>/g,s=/\'/g,o=/\"/g,u=/[&<>\"\']/,a=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};return e}(),Hogan=function(){function e(e,r){function i(){v.length>0&&(g.push(new String(v)),v="")}function s(){var e=!0;for(var t=w;t<g.length;t++){e=g[t].tag&&E[g[t].tag]<E._v||!g[t].tag&&g[t].match(m)===null;if(!e)return!1}return e}function o(e,t){i();if(e&&s())for(var n=w,r;n<g.length;n++)g[n].tag||((r=g[n+1])&&r.tag==">"&&(r.indent=g[n].toString()),g.splice(n,1));else t||g.push({tag:"\n"});y=!1,w=g.length}function u(e,n){var r="="+x,i=e.indexOf(r,n),s=t(e.substring(e.indexOf("=",n)+1,i)).split(" ");return S=s[0],x=s[1],i+r.length-1}var a=e.length,f=0,l=1,c=2,h=f,p=null,d=null,v="",g=[],y=!1,b=0,w=0,S="{{",x="}}";r&&(r=r.split(" "),S=r[0],x=r[1]);for(b=0;b<a;b++)h==f?n(S,e,b)?(--b,i(),h=l):e.charAt(b)=="\n"?o(y):v+=e.charAt(b):h==l?(b+=S.length-1,d=E[e.charAt(b+1)],p=d?e.charAt(b+1):"_v",p=="="?(b=u(e,b),h=f):(d&&b++,h=c),y=b):n(x,e,b)?(g.push({tag:p,n:t(v),otag:S,ctag:x,i:p=="/"?y-x.length:b+S.length}),v="",b+=x.length-1,h=f,p=="{"&&b++):v+=e.charAt(b);return o(y,!0),g}function t(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function n(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var r=1,i=e.length;r<i;r++)if(t.charAt(n+r)!=e.charAt(r))return!1;return!0}function r(e,t,n,o){var u=[],a=null,f=null;while(e.length>0){f=e.shift();if(f.tag=="#"||f.tag=="^"||i(f,o))n.push(f),f.nodes=r(e,f.tag,n,o),u.push(f);else{if(f.tag=="/"){if(n.length===0)throw new Error("Closing tag without opener: /"+f.n);a=n.pop();if(f.n!=a.n&&!s(f.n,a.n,o))throw new Error("Nesting error: "+a.n+" vs. "+f.n);return a.end=f.i,u}u.push(f)}}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return u}function i(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].o==e.n)return e.tag="#",!0}function s(e,t,n){for(var r=0,i=n.length;r<i;r++)if(n[r].c==e&&n[r].o==t)return!0}function o(e,t,n){var r='i = i || "";var c = [cx];var b = i + "";var _ = this;'+f(e)+"return b;";if(n.asString)return"function(cx,p,i){"+r+";}";var i=new HoganTemplate(t);return i.r=new Function("cx","p","i",r),i}function u(e){return e.replace(w,"\\\\").replace(g,'\\"').replace(y,"\\n").replace(b,"\\r")}function a(e){return~e.indexOf(".")?"d":"f"}function f(e){var t="";for(var n=0,r=e.length;n<r;n++){var i=e[n].tag;i=="#"?t+=l(e[n].nodes,e[n].n,a(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):i=="^"?t+=c(e[n].nodes,e[n].n,a(e[n].n)):i=="<"||i==">"?t+=h(e[n]):i=="{"||i=="&"?t+=p(e[n].n,a(e[n].n)):i=="\n"?t+=v('"\\n"'+(e.length-1==n?"":" + i")):i=="_v"?t+=d(e[n].n,a(e[n].n)):i===undefined&&(t+=v('"'+u(e[n])+'"'))}return t}function l(e,t,n,r,i,s){return"if(_.s(_."+n+'("'+u(t)+'",c,p,1),'+"c,p,0,"+r+","+i+', "'+s+'")){'+"b += _.rs(c,p,"+'function(c,p){ var b = "";'+f(e)+"return b;});c.pop();}"+'else{b += _.b; _.b = ""};'}function c(e,t,n){return"if (!_.s(_."+n+'("'+u(t)+'",c,p,1),c,p,1,0,0,"")){'+f(e)+"};"}function h(e){return'b += _.rp("'+u(e.n)+'",c[c.length - 1],p,"'+(e.indent||"")+'");'}function p(e,t){return"b += (_."+t+'("'+u(e)+'",c,p,0));'}function d(e,t){return"b += (_.v(_."+t+'("'+u(e)+'",c,p,0)));'}function v(e){return"b += "+e+";"}var m=/\S/,g=/\"/g,y=/\n/g,b=/\r/g,w=/\\/g,E={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};return{scan:e,parse:function(e,t){return t=t||{},r(e,"",[],t.sectionTags||[])},cache:{},compile:function(t,n){n=n||{};var r=this.cache[t];return r?r:(r=o(this.parse(e(t,n.delimiters),n),t,n),this.cache[t]=r)}}}();typeof module!="undefined"&&module.exports?(module.exports=Hogan,module.exports.Template=HoganTemplate):typeof define=="function"&&define.amd?define(function(){return Hogan}):typeof exports!="undefined"&&(exports.Hogan=Hogan,exports.HoganTemplate=HoganTemplate);